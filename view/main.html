{>page/}
{<page_script}
   <script src="/script/core.js" type="text/javascript"></script>
   <script src="/script/ajax.js" type="text/javascript"></script>
   <script src="/script/dom.js" type="text/javascript"></script>
   <script type="text/javascript">
      function createResource() {
         name = prompt('Enter new {entity} name:', '');
         if (name && name.trim().length > 0) {
            var data = {};
            data.name = name.trim();
            sps.AJAX.post({
               url: '/resource/{entity}',
               content: data,
               onSuccess: function(data) {
                  alert(data);
                  window.location.reload(true);
               },
               onError: function(data) {
                  alert('Connection with server has failed!')
               }
            });
         }
      };
      function deleteResource(name) {
         if(window.confirm('Are you sure to delete ' + name + '?')) {
            var data = {};
            data.name = name;
            sps.AJAX.delete({
               url: '/resource/{entity}',
               content: data,
               onSuccess: function(data) {
                  alert(data);
                  window.location.reload(true);
               },
               onError: function(data) {
                  alert('Connection with server has failed!')
               }
            });            
         }
      };
      function renameResource(currentName) {
         newName = prompt('Enter new name for {entity} ' + currentName, '');
         if (newName && newName.trim().length > 0) {
            var data = {};
            data.from = currentName;
            data.to = newName;
            sps.AJAX.put({
               url: '/resource/{entity}',
               content: data,
               onSuccess: function(data) {
                  alert(data);
                  window.location.reload(true);
               },
               onError: function(data) {
                  alert('Connection with server has failed!')
               }
            });            
         }
      };      
   </script>
   {/page_script}
   {<title}<title>Main Page</title>{/title}   
   {<content}
      <div class="page">
         <form>
            <header class="section center">
               <label class="inline">Database:</label>
               <h2 class="inline">{dbName}</h2>
            </header>
            <div class="section">
               <a href = "#" onClick = "createResource()" class="border link button">Create new {entity}</a>
            </div>
            <table class="data">
               <thead>
                  <tr>
                     <th scope="col">{entity}</th>
                     <th scope="col" colspan="2">Action</th>
                  </tr>
               </thead>
               <col id="entity-name"/>
               <col id="actions"/>
               <tbody>
                  <tr>
                     <td><a href="/resource/list/post">To work with post collection we already have corresponding templates</a></td>
                     <td>
                     </td>
                     <td>
                     </td>
                  </tr>
                  {#entityNames}
                  <tr>
                     <td><a href="/resource/list/{.}">{.}</a></td>
                     <td>
                        <a href = "#" onClick = "renameResource('{.}')" class="link button">Rename</a>
                     </td>
                     <td>
                        <a href = "#" onClick = "deleteResource('{.}')" class="link button">Delete</a>
                     </td>
                  </tr>
                  {/entityNames}
               </tbody>
            </table>
         </form>
      </div>
      {/content}